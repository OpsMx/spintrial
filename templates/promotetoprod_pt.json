{"id":"opsmx-001-PromoteToProd-2019","metadata":{"description":"Pipeline Template for PromotetoProdBlueGreen for SimpleToBlueGreen","name":"PromotetoProdBlueGreen","owner":"trialspin@opsmx.com","scopes":["global"]},"pipeline":{"keepWaitingPipelines":false,"lastModifiedBy":"${ trigger[user] }","limitConcurrent":true,"parameterConfig":[{"default":"simple-newrelic-green-1.0","description":"version to deploy","hasOptions":true,"label":"version","name":"version","options":[{"value":"simple-newrelic-2.1"},{"value":"simple-newrelic-green-1.0"}],"pinned":true,"required":true},{"default":"${ trigger[user] }","description":"Deploy Service","hasOptions":false,"label":"service","name":"service","options":[{"value":""}],"pinned":true,"required":true}],"stages":[{"failPipeline":true,"judgmentInputs":[{"value":"Success"},{"value":"Failure"}],"name":"Verify Test","notifications":[],"refId":"1","requisiteStageRefIds":[],"type":"manualJudgment"},{"account":"dev-k8s-v2","cloudProvider":"kubernetes","manifestArtifactAccount":"docker-registry","manifests":[{"apiVersion":"extensions/v1beta1","kind":"ReplicaSet","metadata":{"name":"opsmx-deploys-production","namespace":"${ trigger[user] }"},"spec":{"replicas":1,"selector":{"matchLabels":{"version":"${parameters.version}"}},"template":{"metadata":{"labels":{"version":"${parameters.version}"}},"spec":{"containers":[{"image":"docker.io/opsmx11/restapp:${parameters.version}","imagePullPolicy":"Always","name":"restapp","ports":[{"containerPort":8080,"name":"http","protocol":"TCP"},{"containerPort":9090,"name":"prometheus","protocol":"TCP"}]}]}}}}],"moniker":{"app":"${ trigger[user] }"},"name":"Production_Deploy","refId":"2","relationships":{"loadBalancers":[],"securityGroups":[]},"requisiteStageRefIds":["1"],"skipExpressionEvaluation":false,"source":"text","trafficManagement":{"enabled":true,"options":{"enableTraffic":true,"namespace":"${ trigger[user] }","services":["service ${ trigger[user] }"],"strategy":"redblack"}},"type":"deployManifest"}],"triggers":[]},"protect":false,"schema":"v2","variables":[]}
